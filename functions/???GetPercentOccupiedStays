-----ma zwracac ilsoc zajetych miejsc w danym dniu ale cos nie dziala  w @occupiedPlaces 
---- moze ktos wie jak to naprawic 
CREATE OR ALTER FUNCTION dbo.GetPercentOccupiedStays 
(@date  AS datetime)
RETURNS FLOAT
AS
BEGIN
DECLARE @totalPlaces INT
DECLARE @occupiedPlaces INT
DECLARE @percentOccupied FLOAT

SELECT @totalPlaces = COUNT(*)
FROM housing h

SELECT @occupiedPlaces = COUNT(*)
FROM reservation r
WHERE (@date BETWEEN r.start_date AND r.end_date) ---- ????
IF (@totalPlaces > 0)
BEGIN
SET @percentOccupied = (@occupiedPlaces / @totalPlaces) * 100
END
ELSE
SET @percentOccupied = 0
RETURN @percentOccupied
END
GO

DECLARE @date datetime = '2023-11-24'
SELECT dbo.GetPercentOccupiedStays (@date)
